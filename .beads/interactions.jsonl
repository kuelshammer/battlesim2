{"id":"Battlesim2-191","title":"Expose AI Decision Trace in Logs","description":"Include the AI's internal scoring matrix in ActionStarted events to make decision logic transparent.","design":"# Implementation Plan\n\n## Proposed Changes\n\n### [Backend] simulation-wasm\n\n#### [MODIFY] execution.rs\n- Update `select_actions_for_combatant` to return both selected actions and a `HashMap\u003cString, f64\u003e` \"decision trace\" containing scores of all evaluated actions.\n- Update `execute_combatant_turn` to handle the trace.\n- Update `execute_action_with_reactions` to accept an optional `decision_trace`.\n- Pass the trace to `Event::ActionStarted`.\n\n#### [MODIFY] events.rs\n- Update `Event::format_for_log` to display the `decision_trace` in the CLI output.\n\n### [Frontend] TypeScript / React\n\n#### [MODIFY] model.ts\n- Update `EventSchema` for `ActionStarted` to include `decision_trace: Record\u003cstring, number\u003e`.\n\n#### [MODIFY] logFormatter.ts\n- Update `LogFormatter.toDetails` to handle `ActionStarted` events and format the `decision_trace`.\n\n#### [MODIFY] EventLog.tsx\n- Ensure `ActionStarted` events are marked as `hasDetails` if a `decision_trace` is present.\n\n## Verification Plan\n- **Automated**: Run `cargo test` and add a test case for trace population.\n- **Manual**: Verify CLI output and UI breakdown.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T07:13:08.066028+01:00","updated_at":"2025-12-27T10:32:13.991742+01:00","closed_at":"2025-12-27T10:32:13.991742+01:00","close_reason":"Closed","labels":["backend","frontend"]}
{"id":"Battlesim2-1h0","title":"Project Migration: Conductor to Beads","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-26T18:29:39.868231+01:00","updated_at":"2025-12-26T23:45:14.414414+01:00","closed_at":"2025-12-26T23:45:14.414414+01:00","close_reason":"All sub-tasks (cleanup, frontend polish, and backend diagnostics) are complete. Project is now fully powered by Beads.","labels":["tech-debt"]}
{"id":"Battlesim2-1rv","title":"Implement Multi-Run Tail Auditing","description":"Extend the auditor to verify 10 random runs from the 2511-batch to ensure compliance in edge cases.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T07:13:02.883898+01:00","updated_at":"2025-12-27T07:16:30.162305+01:00","closed_at":"2025-12-27T07:16:30.162305+01:00","close_reason":"Implemented multi-run auditing with 'batch-log' command and updated scripts.","labels":["backend","quality"]}
{"id":"Battlesim2-1ub","title":"Delete deprecated Conductor tracking files","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T18:29:45.058632+01:00","updated_at":"2025-12-26T18:30:56.036314+01:00","closed_at":"2025-12-26T18:30:56.036314+01:00","close_reason":"Conductor tracking files removed.","labels":["tech-debt"],"dependencies":[{"issue_id":"Battlesim2-1ub","depends_on_id":"Battlesim2-1h0","type":"parent-child","created_at":"2025-12-26T18:30:40.544373+01:00","created_by":"daemon"}]}
{"id":"Battlesim2-2ll","title":"Implement Rule Auditor for 5e Compliance","description":"A script to validate JSON logs against 5e Action Economy, Concentration, and Resource constraints.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T23:48:22.494485+01:00","updated_at":"2025-12-26T23:49:34.660371+01:00","closed_at":"2025-12-26T23:49:34.660371+01:00","close_reason":"Implemented Rule Auditor with checks for Action Economy, Reaction limits, and Concentration cleanup on death.","labels":["backend","quality"]}
{"id":"Battlesim2-61w","title":"Fix Rust/WASM compilation warnings","description":"Fix Rust compiler warnings in simulation-wasm:\n\n- Remove unused imports (Encounter, HashMap, IntensityTier, etc.)\n- Fix unused variables (_players, _report, mut variables that don't need mut)\n- Clean up warnings in tests/decile_test.rs and tests/reliability_tests.rs\n\nRun `cargo clippy` and `cargo test` to verify all warnings are resolved.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T10:37:38.273239+01:00","updated_at":"2025-12-27T11:04:59.357853+01:00","closed_at":"2025-12-27T11:04:59.357853+01:00","close_reason":"Closed"}
{"id":"Battlesim2-d3w","title":"Avant-Garde Visual Refactor: The Grimoire Log","description":"Redesign the EventLog using bespoke typography and asymmetric layouts to move away from generic material UI.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T07:13:13.24283+01:00","updated_at":"2025-12-27T07:13:13.24283+01:00","labels":["design","frontend"]}
{"id":"Battlesim2-dxt","title":"Improve test coverage in simulation-wasm","description":"Review and improve test coverage:\n\n1. Run cargo tarpaulin or similar tool to measure coverage\n2. Identify modules with low test coverage\n3. Add tests for uncovered code paths\n4. Focus on core modules: execution.rs, events.rs, action_resolver.rs\n5. Add edge case tests (empty inputs, boundary conditions, error paths)","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-27T10:38:22.40063+01:00","updated_at":"2025-12-27T10:38:34.917779+01:00"}
{"id":"Battlesim2-fzh","title":"Optimize LogFormatter.ts for better roll breakdown","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T18:29:50.242214+01:00","updated_at":"2025-12-26T22:43:25.55263+01:00","closed_at":"2025-12-26T22:43:25.55263+01:00","close_reason":"Optimized mathematical breakdown for all roll types.","labels":["frontend"],"dependencies":[{"issue_id":"Battlesim2-fzh","depends_on_id":"Battlesim2-1h0","type":"parent-child","created_at":"2025-12-26T18:30:45.705946+01:00","created_by":"daemon"}]}
{"id":"Battlesim2-g4u","title":"Resolve Rust Compilation Warnings","description":"Identify and fix various compilation warnings in the simulation-wasm Rust codebase, including unused imports, unused variables, and naming convention issues.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T09:55:20.788439+01:00","updated_at":"2025-12-27T10:17:21.438017+01:00","closed_at":"2025-12-27T10:17:21.438017+01:00","close_reason":"Closed"}
{"id":"Battlesim2-tu9","title":"Add integration scenario tests for D\u0026D 5e mechanics","description":"## Overview\nAdd integration tests using real D\u0026D 5e encounter scenarios to validate simulation logic and catch emergent bugs that unit tests miss.\n\n## Why This Matters\n- **Regression protection**: Detect when logic changes break expected behavior\n- **Emergent bugs**: Catch issues from system interactions (actions + resources + reactions)\n- **Living documentation**: Scenarios document expected D\u0026D 5e behavior\n- **Refactoring safety**: Improve code with confidence tests pass\n\n## Implementation Phases\n\n### Phase 1: Framework\n- Create `tests/scenarios/` directory structure\n- Write `integration_test.rs` test runner\n- Create `invariants.rs` with assertion helpers\n\n### Phase 2: Basic Mechanical Scenarios\n- 01_single_attack.json - Basic attack resolution\n- 02_fireball_aoe.json - AOE damage calculation\n- 03_healing_word.json - Bonus action spell\n- 04_concentration_check.json - Concentration mechanics\n- 05_multiattack.json - Multiple attacks per action\n\n### Phase 3: Complex Encounters\n- goblin_bandits.json - Multi-combatant combat\n- Resource management scenarios\n- Edge cases (temp HP, resistance, death saves)\n\n## Assertion Strategy\nAssert BEHAVIORS, not exact outcomes:\n- No negative HP or resources\n- Damage dealt = damage taken (energy conserved)\n- Action economy respected (1 action/turn max)\n- Event sequence validity\n- Concentration mechanics work correctly\n\n## Directory Structure\n```\nsimulation-wasm/tests/\n├── scenarios/\n│   ├── basic/\n│   ├── edge_cases/\n│   └── complex/\n├── integration_test.rs\n└── invariants.rs\n```\n\n## Dependencies\nShould be done AFTER:\n- Battlesim2-61w: Fix Rust warnings\n- Battlesim2-dxt: Improve test coverage\n\n## Notes\n- Scenarios use existing AdventuringDaySchema JSON format\n- User creates realistic encounters via UI, exports to JSON\n- Tests automatically validate all scenarios in directory","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-27T10:44:50.480731+01:00","updated_at":"2025-12-27T10:45:27.491912+01:00"}
{"id":"Battlesim2-wpt","title":"Implement AI Action Diagnostics in combat log","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-26T18:29:55.422859+01:00","updated_at":"2025-12-26T22:43:30.717651+01:00","closed_at":"2025-12-26T22:43:30.717651+01:00","close_reason":"Integrated skipped action diagnostics with UI warning states.","labels":["backend"],"dependencies":[{"issue_id":"Battlesim2-wpt","depends_on_id":"Battlesim2-1h0","type":"parent-child","created_at":"2025-12-26T18:30:50.865678+01:00","created_by":"daemon"}]}
